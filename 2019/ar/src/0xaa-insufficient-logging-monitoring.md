<h2 dir='rtl' align='right'> API10:2019 خلل في طريقة تسجيل الاحداث والمراقبة </h2>


<table dir='rtl' align="right">
  <tr>
    <th>عوامل التهديد/ الاستغلال  </th>
    <th> نقاط الضعف </th>
    <th> التأثير </th>
  </tr>
  <tr>
    <td> خصائص API : قابلية الاستغلال 2 </td>
    <td> الانتشار : 3 قابلية الاكتشاف : 1  </td>
    <td> التأثر التقني و تأثر الاعمال: 2 </td>
  </tr>
  <tr>
     <td> يستغل المهاجمون عدم تسجيل الاحداث وحركة مرور البيانات للقيام بأنشطة ضارة. </td>
    <td> من دون وجود آلية او نظام لتسجيل حركة مرور البيانات او الاحداث سيكون هناك نظام مراقبة غير كفء، بل قد يصل في بعض الأحيان الى أستحالة تتبع الأنشطة الضارة واتخاذ الاجراءات في الوقت المناسب. </td>
    <td> من غير الحصول على تغطية شاملة لحركة المرور والسجلات سيكون لدى المهاجمين المقدرة على اختراق الأنظمة من غير وجود أي آلية لرصدهم او تتبع تحركاتهم داخل الأنظمة. </td>    
  </tr>
</table>
<h3 dir='rtl' align='right'>هل أنا معرض لهذه الثغرة؟</h3>

<p dir='rtl' align='right'> سيكون النظام لديك معرض اذا كان: 

<p dir='rtl' align='right'>▪️ لا يتم استخراج أي سجلات او لم يتم تعين عمليات التسجيل بالشكل الصحيح او لم يتم جمع السجلات بشكل كافي وناضج.
<p dir='rtl' align='right'>▪️ عند عدم ضمان السجلات (على سبيل المثال في حال حقن السجلات بسجلات غير صحيح)
<p dir='rtl' align='right'>▪️ لا يتم مراقبة السجلات بشكل مستمر
<p dir='rtl' align='right'>▪️ لا يتم مراقبة البنية التحتية لواجهة برمجة التطبيقات API بشكل مستمر.
    
<h3 dir='rtl' align='right'> امثلة على سيناريوهات الهجوم: </h3>

<h4 dir='rtl' align='right'>السيناريو الاول: </h4>

<p dir='rtl' align='right'> عن طريق الخطأ تم تسريب احد مفاتيح إدارة المستودعات في احد قواعد البيانات العامة، تم أخطار مالك المستودع عن طريق البريد الالكتروني بشأن التسريب المحتمل، ولكن لم يقم مالك المستودع من التجاوب خلال 48 ساعة والتصرف بشأن هذا التسريب، و من المحتمل استخدام هذه المفاتيح في عمليات تسريب البيانات، ولكن بسبب عدم كفاية موارد تسجيل السجلات والاحداث لا تستطيع الشركة تقييم ومعرفة الأصول والبيانات التي تم الوصول لها او في حال تم تسريبها.

<h4 dir='rtl' align='right'>السيناريو الثاني : </h4>

<p dir='rtl' align='right'> تم استهداف أحد منصات مشاركة ملفات الفيديو بهجمات كسر كلمات المرور المسربة مسبقاً من أحد الهجمات السابقة. على الرغم من عدد المحاولات تسجيل الدخول غير الصحيحة لم يتم تفعيل التنبيهات خلال فترة الهجوم، وكردة فعل قام المستخدمين بالشكوى من اغلاق الحسابات الخاصة بهم بسبب عدد المحاولات، وبعد عملية تحليل السجلات الخاصة بواجهات برمجة التطبيقات API تبين ان هناك فعلاً هجوم وكان على الشركة اصدار اعلان لجميع المستخدمين بتغير كلمات المرور الخاصة. 


<h4 dir='rtl' align='right'>كيف أمنع هذه الثغرة؟ </h4>

<p dir='rtl' align='right'>▪️ قم بتسجيل جميع محاولات المصادقة الفاشلة او محاولات رفض الوصول للمجلدات او الامتدادات وكذلك جميع المدخلات المحجوبة.
<p dir='rtl' align='right'>▪️ يجب كتابة السجلات بشكل متناسق لاستخدامه في عمليات إدارة السجلات ويجب ان تتضمن كافة التفاصيل التي تتيح للمحلل معرفة الأنشطة الضارة ومن قام بها.
<p dir='rtl' align='right'>▪️ يجب التعامل مع السجلات باعتبارها بيانات حساسة ويجب ضمان سلامتها اثناء المرور و التخزين.
<p dir='rtl' align='right'>▪️ قم بإعداد عمليات المراقبة واجعلها مستمرة ولتشمل البنية التحتية والشبكات و واجهة برمجة التطبيقات API.
<p dir='rtl' align='right'>▪️ استخدام أنظمة SIEM  لإدارة السجلات من جميع المصادر والأنظمة و واجهات برمجة التطبيقات.
<p dir='rtl' align='right'>▪️ قم بإعداد لوحة مراقبة مخصصة للتنبيهات الأمنية وقم بتفعيل التواقيع الرقمية لرصد الأنشطة المشبوهة لرصدها في مراحلها الأولية.

<h4 dir='rtl' align='right'>المراجع :  </h4>

[<p dir='rtl' align='right'>▪️ OWASP Logging Cheat Sheet </p>]( https://www.owasp.org/index.php/Logging_Cheat_Sheet)
[<p dir='rtl' align='right'>▪️ OWASP Proactive Controls: Implement Logging and Intrusion Detection </p>](https://www.owasp.org/index.php/OWASP_Proactive_Controls)
[<p dir='rtl' align='right'>▪️ OWASP Application Security Verification Standard: V7: Error Handling and
  Logging Verification Requirements </p>](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x15-V7-Error-Logging.md)

<h4 dir='rtl' align='right'>المصادر الخارجية : </h4>

[<p dir='rtl' align='right'>▪️ CWE-223: Omission of Security-relevant Information </p>]( https://cwe.mitre.org/data/definitions/223.html)
[<p dir='rtl' align='right'>▪️ CWE-778: Insufficient Logging </p>]( https://cwe.mitre.org/data/definitions/778.html)

[1]: https://www.owasp.org/index.php/Log_Injection

